(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{105:function(t,e,i){"use strict";function n(t,e,i,n,r,s,o,a){var l,u="function"==typeof t?t.options:t;if(e&&(u.render=e,u.staticRenderFns=i,u._compiled=!0),n&&(u.functional=!0),s&&(u._scopeId="data-v-"+s),o?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),r&&r.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(o)},u._ssrRegister=l):r&&(l=a?function(){r.call(this,this.$root.$options.shadowRoot)}:r),l)if(u.functional){u._injectStyles=l;var d=u.render;u.render=function(t,e){return l.call(e),d(t,e)}}else{var c=u.beforeCreate;u.beforeCreate=c?[].concat(c,l):[l]}return{exports:t,options:u}}i.d(e,"a",function(){return n})},244:function(t,e,i){for(var n=i(40),r=i(41),s=i(6),o=i(1),a=i(4),l=i(11),u=i(0),d=u("iterator"),c=u("toStringTag"),h=l.Array,f={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},v=r(f),p=0;p<v.length;p++){var g,m=v[p],_=f[m],w=o[m],x=w&&w.prototype;if(x&&(x[d]||a(x,d,h),x[c]||a(x,c,m),l[m]=h,_))for(g in n)x[g]||s(x,g,n[g],!0)}},247:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"wrapper mt-8"},[i("div",{staticClass:"w-1/2 mx-auto mb-8"},[i("div",{staticClass:"flex mb-4"},[i("select",{staticClass:"flex-1 text-xl",on:{change:t.switchJournal}},[t._l(t.journals,function(e){return i("option",{domProps:{value:e.id,selected:t.journal_id==e.id}},[t._v(t._s(e.name))])}),t._v(" "),i("option",{attrs:{disabled:"disabled"}},[t._v("--")]),t._v(" "),i("option",{attrs:{value:""}},[t._v("+ New Journal")])],2),t._v(" "),t.journals.length>1?i("button",{staticClass:"flex1 px-4",on:{click:function(e){return e.preventDefault(),t.deleteJournal(e)}}},[t._v("Delete")]):t._e()]),t._v(" "),i("form",{on:{submit:function(e){return e.preventDefault(),t.saveEntry(e)}}},[i("div",{staticClass:"relative"},[i("div",{staticClass:"relative",attrs:{id:"entry-uploader"}},[i("div",{staticClass:"absolute pin z-0"},[i("input",{attrs:{type:"file",multiple:"multiple",accept:"image/*"},on:{change:t.acceptFile}})]),t._v(" "),i("div",{staticClass:"relative z-10"},[i("textarea",{staticClass:"w-full p-2 bg-white rounded-sm focus:outline-none overflow-hidden resize-none text-lg leading-tight",attrs:{placeholder:"How's your day going?",rows:"3"},on:{input:t.textareaHeight}})]),t._v(" "),t.entry.media&&t.entry.media.length?i("div",{staticClass:"flex relative z-10 flex bg-white p-1 entry-media"},t._l(t.entry.media,function(e,n){return i("div",{staticClass:"relative p-1 media-item"},[i("img",{staticClass:"w-full h-full rounded-sm object-cover",attrs:{src:e.url,alt:"media upload"}}),t._v(" "),i("button",{staticClass:"absolute p-1 rounded-full text-white text-xs",attrs:{type:"button"},on:{click:function(e){e.preventDefault(),t.deleteMedia(n)}}},[i("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}},[i("line",{attrs:{x1:"18",y1:"6",x2:"6",y2:"18"}}),t._v(" "),i("line",{attrs:{x1:"6",y1:"6",x2:"18",y2:"18"}})])])])}),0):t._e()])]),t._v(" "),t.form.fields.length?i("div",t._l(t.form.fields,function(e){return i("div",[i("label",{staticClass:"block text-lg font-bold",attrs:{for:"field-"+e.id}},[t._v(t._s(e.label))]),t._v(" "),i("input",{attrs:{type:e.type,id:"field-"+e.id,value:""},on:{change:t.fieldChange}})])}),0):t._e(),t._v(" "),i("div",{staticClass:"flex mt-2"},[i("div",{staticClass:"flex-1"},[i("button",{staticClass:"p-2 rounded-full text-indigo hover:bg-indigo hover:text-white",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.touchDropzone(e)}}},[i("svg",{staticClass:"block stroke-current",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}},[i("rect",{attrs:{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}}),t._v(" "),i("circle",{attrs:{cx:"8.5",cy:"8.5",r:"1.5"}}),t._v(" "),i("polyline",{attrs:{points:"21 15 16 10 5 21"}})])]),t._v(" "),i("button",{staticClass:"p-2 rounded-full text-indigo hover:bg-indigo hover:text-white",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.changeFeeling(e)}}},[i("svg",{staticClass:"block stroke-current",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}},[i("circle",{attrs:{cx:"12",cy:"12",r:"10"}}),t._v(" "),i("path",{attrs:{d:"M8 14s1.5 2 4 2 4-2 4-2"}}),t._v(" "),i("line",{attrs:{x1:"9",y1:"9",x2:"9.01",y2:"9"}}),t._v(" "),i("line",{attrs:{x1:"15",y1:"9",x2:"15.01",y2:"9"}})])])]),t._v(" "),i("div",{staticClass:"flex-1 text-right"},[i("button",{staticClass:"px-8 py-3 bg-indigo rounded-full font-bold text-sm text-white uppercase",attrs:{type:"submit",disabled:t.form.disabled}},[t._v("Post")])])])])]),t._v(" "),i("div",{staticClass:"w-1/2 mx-auto"},[i("div",{staticClass:"bg-white rounded-sm",attrs:{id:"entries"}},t._l(t.entries,function(e,n){return i("div",{staticClass:"relative p-4 border-b border-grey-lighter"},[i("span",{staticClass:"block mb-2 text-xs text-grey-dark",attrs:{title:t._f("formatted")(e.created)}},[t._v(t._s(t._f("timeAgoInWords")(e.created)))]),t._v(" "),i("div",{staticClass:"leading-normal"},[t._v(t._s(e.content))]),t._v(" "),i("button",{staticClass:"absolute pin-t pin-r p-2 text-xs text-grey-light",on:{click:function(e){t.deleteEntry(n)}}},[i("svg",{staticClass:"block stroke-current",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}},[i("polyline",{attrs:{points:"3 6 5 6 21 6"}}),t._v(" "),i("path",{attrs:{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}}),t._v(" "),i("line",{attrs:{x1:"10",y1:"11",x2:"10",y2:"17"}}),t._v(" "),i("line",{attrs:{x1:"14",y1:"11",x2:"14",y2:"17"}})])])])}),0)])])};n._withStripped=!0;i(244),i(39);var r={props:["user"],data:function(){return{entry:{content:"",media:[]},entries:[],journals:[],journal_id:null,form:{disabled:!0,fields:[],lineheight:22.5,rows:3,uploader:null}}},created:function(){var t=this;eventHub.$on("render-entries",function(){t.renderEntries()}),Journals.iterate(function(e){t.journals.push(e)})},filters:{formatted:t=>dateFormat(new Date(t),"PPpp"),timeAgoInWords:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(t=>timeAgoInWords(new Date(t),new Date,{addSuffix:!0}))},mounted:function(){},watch:{entries:function(){},user:function(t){}},methods:{saveEntry:function(t){var e=this,i=t.target.querySelector("textarea"),n={};if(this.form.fields.length)for(var r=0;r<this.form.fields.length;r++){var s=this.$el.querySelector("#field-"+this.fields[r].id);n[this.fields[r].id]=s.value}var o=Date.now();Entries.setItem(String(o),{id:null,created:o,content:i.value,fields:n}).then(t=>{e.entries.unshift(t),i.value="",i.rows=this.form.rows})},deleteEntry:function(t){var e=this.entries[t];Entries.removeItem(String(e.created)),this.entries.splice(t,1)},renderEntries:function(){var t=this;if(Entries){t.journal_id=Entries.config("storeName");var e=[];Entries.iterate((t,i)=>{e.unshift(t)}).then(()=>{t.entries=e})}},syncEntries:function(){if(this.user)for(var t=0;t<this.$root.entries.length;t++){var e=this.$root.entries[t];e.id||axios.post(api_endpoint+"/entries",e,{headers:{Authorization:this.user.signInUserSession.idToken.jwtToken}}).then(t=>console.log(t.data)).catch(t=>console.log(t))}},fetchEntries:function(){window.axios.get(api_endpoint+"/entries",{headers:{Authorization:this.user.signInUserSession.idToken.jwtToken}}).then(t=>console.log(t.data)).catch(t=>console.log(t))},textareaHeight:function(t){this.form.disabled=""==t.target.value.trim(),this.entry.content=t.target.value.trim(),t.target.rows=this.form.rows;var e=this.form.lineheight*this.form.rows+16;t.target.scrollHeight>e?t.target.rows=this.form.rows+Math.ceil((t.target.scrollHeight-e)/this.form.lineheight):t.target.rows=this.form.rows},switchJournal:function(t){var e=this;Journals.iterate(t=>{t.active=!1,Journals.setItem(t.id,t)}).then(()=>{if(t.target.value)Journals.getItem(t.target.value).then(t=>{t.active=!0,Journals.setItem(t.id,t),Entries=localforage.createInstance({driver:localforage.INDEXEDDB,name:app_name,storeName:String(t.id)}),eventHub.$emit("render-entries")});else{var i=uuidv4();Journals.setItem(i,{id:i,name:"My Journal",active:!0}).then(t=>{e.journals.push(t),Entries=localforage.createInstance({driver:localforage.INDEXEDDB,name:app_name,storeName:String(t.id)}),eventHub.$emit("render-entries")})}})},deleteJournal:function(){if(this.journal_id&&!(this.journals.length<2)){var t=this;confirm("Are you sure?")&&Journals.getItem(this.journal_id).then(e=>Journals.removeItem(t.journal_id)).then(()=>Entries.dropInstance()).then(()=>{var e=[];Journals.iterate((i,n,r)=>{1==r&&(i.active=!0,Journals.setItem(i.id,i),Entries=localforage.createInstance({driver:localforage.INDEXEDDB,name:app_name,storeName:String(i.id)}),t.journal_id=i.id),e.push(i)}).then(()=>{t.journals=e,eventHub.$emit("render-entries")})})}},touchDropzone:function(t){document.querySelector("#entry-uploader input[type=file]").click()},acceptFile:function(t){var e=this,i=Promise.resolve();Object.keys(t.target.files).map(n=>{var r=t.target.files[n];r.size>5263360&&console.log("File size too large."),i.then(()=>e.readMediaFile(r)).then(()=>{t.target.value=null})})},readMediaFile:function(t){var e=this;return new Promise((i,n)=>{var r=new FileReader;r.readAsDataURL(t),r.onload=function(){e.entry.media.push({id:null,name:t.name,size:t.size,type:t.type,url:r.result,created:Date.now()}),i()}})},deleteMedia:function(t){this.entry.media.splice(t,1)},changeFeeling:function(t){alert("how do you feel?")}}},s=i(105),o=Object(s.a)(r,n,[],!1,null,null,null);o.options.__file="src/js/components/entries.vue";e.default=o.exports}}]);